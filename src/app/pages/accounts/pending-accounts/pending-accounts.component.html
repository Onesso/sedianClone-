<!-- Start Breadcrumbs -->
<app-breadcrumbs
  title="Pending Accounts"
  [breadcrumbItems]="breadCrumbItems"
></app-breadcrumbs>
<!-- End Breadcrumbs -->

<div class="row">
  <div class="col-lg-12">
    <div class="card" id="ticketsList">
      <div class="card-header border border-dashed border-end-0 border-start-0">
        <div class="row g-3">
          <div class="col-lg-3 col-sm-6">
            <div class="search-box">
              <input
                type="text"
                class="form-control search"
                placeholder="Search by ID/Tracking NO."
                [(ngModel)]="searchObject"
              />
              <i class="ri-search-line search-icon"></i>
            </div>
          </div>

          <!--Start date-->
          <div class="col-lg-1 col-sm-4">
            <div>
              <button
                type="button"
                class="btn btn-primary w-100"
                (click)="getCustomerById()"
                [disabled]="searchObject === ''"
              >
                <i
                  class="ri-search-2-line me-2 align-bottom"
                  *ngIf="!searchingById"
                ></i>
                <span
                  class="spinner-border spinner-border-sm"
                  role="status"
                  aria-hidden="true"
                  *ngIf="searchingById"
                ></span>
              </button>
            </div>
          </div>
          <!--End date-->
          <div class="col-lg-2 col-sm-6">
            <div class="mb-3">
              <input
                [(ngModel)]="selectedStartDate"
                class="form-control flatpickr-input"
                (change)="onStartDateSelect()"
                placeholder="Start date"
                type="text"
                mwlFlatpickr
                [altInput]="true"
                [convertModelValue]="true"
              />
            </div>
          </div>

          <div class="col-lg-2 col-sm-6">
            <div class="mb-3">
              <input
                [(ngModel)]="selectedEndDate"
                class="form-control flatpickr-input"
                placeholder="End date"
                (change)="onEndDateSelect()"
                type="text"
                mwlFlatpickr
                [altInput]="true"
                [convertModelValue]="true"
              />
            </div>
          </div>
          <div class="col-lg-1 col-sm-4">
            <div>
              <button
                type="button"
                class="btn btn-primary w-100"
                (click)="searchCustomersByDate()"
                [disabled]="
                  startDate === '' || endDate === '' || searchingByDate
                "
              >
                <i
                  class="ri-search-2-line me-2 align-bottom"
                  *ngIf="!searchingByDate"
                ></i>
                <span
                  class="spinner-border spinner-border-sm"
                  role="status"
                  aria-hidden="true"
                  *ngIf="searchingByDate"
                ></span>
              </button>
            </div>
          </div>
          <!--end col-->
          <!-- <div class="col-lg-3 col-sm-6">
                        <div>
                            <input type="text" class="form-control" mwlFlatpickr [convertModelValue]="true" (change)="onDateSelect()"
                                data-date-format="d M, Y" data-range-date="true" id="demo-datepicker"
                                placeholder="Select date" [(ngModel)]="selectedDates" mode="range">
                        </div>
                    </div>    -->
          <div class="col-lg-1 col-sm-4" ngbDropdown>
            <div>
              <button
                data-bs-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                ngbDropdownToggle
                type="button"
                class="btn btn-primary w-100"
              >
                <i
                  class="ri-filter-2-fill me-2 align-bottom"
                  *ngIf="!searchingByAccType"
                ></i>
                <span
                  class="spinner-border spinner-border-sm"
                  role="status"
                  aria-hidden="false"
                  *ngIf="searchingByAccType"
                ></span>
              </button>
              <div class="dropdown-menu dropdown-menu-end" ngbDropdownMenu>
                <a type="button" class="dropdown-item">
                  <span class="align-middle">Nawiri Account</span></a
                >

                <div class="dropdown-divider"></div>
                <a type="button" class="dropdown-item">
                  <span class="align-middle">Mshahara Account</span></a
                >

                <div class="dropdown-divider"></div>
                <a type="button" class="dropdown-item">
                  <span class="align-middle">Savings Account</span></a
                >
              </div>
            </div>
          </div>

          <div class="col-lg-2 col-12">
            <div>
              <button
                type="button"
                class="btn btn-warning w-100"
                (click)="exportexcel()"
              >
                <i class="ri-file-excel-2-line align-bottom me-1"></i> Excel
              </button>
            </div>
          </div>
        </div>
      </div>

      <!--end card-body-->
      <div class="card-body">
        <div class="table-responsive table-card mb-3">
          <table class="table table-nowrap align-middle" id="customerTable">
            <thead class="text-muted table-light">
              <tr class="text-uppercase">
                <th style="width: 140px">Date Created</th>
                <th>ID</th>
                <th>Account Number</th>
                <th>Reference Number</th>
                <th>Account Name</th>
                <th>Product</th>
                <th>Email</th>
                <th>Promo Code</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody class="list form-check-all">
              <tr
                *ngFor="let data of pendingAccs; let i = index"
                id="a_{{ data.groupCode }}"
              >
                <td class="id">
                  <a
                    href="javascript:void(0);"
                    class="fw-medium link-primary"
                    >{{ data.createdDate | date : "medium" }}</a
                  >
                </td>
                <td class="company">
                  <a href="javascript:void(0);" class="fw-medium link-primary">
                    {{ data.nationalId ? data.nationalId : "-" }}</a
                  >
                </td>
                <td class="designation">
                  {{ data.accountNo ? data.accountNo : "-" }}
                </td>
                <td class="designation">
                  {{ data.accountName ? data.accountName : "-" }}
                </td>
                <td class="date">
                  {{ data.productName ? data.productName : "-" }}
                </td>
                <td class="contacts">{{ data.email ? data.email : "-" }}</td>
                <td class="type">
                  {{ data.salesCode ? data.salesCode : "-" }}
                </td>
                <td>
                  <ul class="list-inline hstack gap-2 mb-0">
                    <li
                      class="list-inline-item"
                      data-bs-toggle="tooltip"
                      (click)="viewAccount(data.groupCode)"
                      data-bs-trigger="hover"
                      data-bs-placement="top"
                      ngbTooltip="View Details"
                    >
                      <button
                        class="btn btn-sm view-btn edit-item-btn"
                        data-bs-toggle="modal"
                        data-bs-target="#showModal"
                      >
                        <i class="ri-eye-fill fs-16"></i>
                      </button>
                    </li>
                  </ul>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div
          *ngIf="this.pendingAccs.length === 0 && !loading"
          class="table-responsive table-card mb-1"
        >
          <div class="noresult">
            <div class="text-center">
              <lord-icon
                src="https://cdn.lordicon.com/msoeawqm.json"
                trigger="loop"
                colors="primary:#405189,secondary:#0ab39c"
                style="width: 75px; height: 75px"
              >
              </lord-icon>
              <h5 class="mt-2">Sorry! No Records Found</h5>
              <p class="text-muted">
                We've searched more than 150+ result We did not find results for
                you search.
              </p>
            </div>
          </div>
          <div></div>
        </div>

        <div class="row justify-content-md-between align-items-md-center">
          <div class="col col-sm-6">
            <div
              class="dataTables_info mb-2"
              id="tickets-table_info"
              role="status"
              aria-live="polite"
            >
              Showing
              {{ this.startIndex }} to {{ this.endIndex }} of
              {{ this.totalRecords }}
              entries
            </div>
          </div>
          <!-- Pagination -->
          <div class="col col-sm-6">
            <div class="text-sm-right float-sm-end listjs-pagination">
              <ngb-pagination
                [collectionSize]="this.totalRecords"
                [(page)]="this.currentPage"
                [pageSize]="this.pageSize"
                (pageChange)="onPageChange($event)"
              >
              </ngb-pagination>
            </div>
          </div>
          <!-- End Pagination -->
        </div>
      </div>
      <!--end card-body-->
    </div>
    <!--end card-->
    <div id="elmLoader">
      <div class="spinner-border text-primary avatar-sm" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  </div>
  <!--end col-->
</div>
